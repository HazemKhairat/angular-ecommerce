import{c as U,f as $,i as X,l as Y,m as Z,n as ee,p as te}from"./chunk-RPPOXTPC.js";import{a as D}from"./chunk-5L3ANNXC.js";import{b as x}from"./chunk-B5HERMYD.js";import{a as K}from"./chunk-SPD2RTNC.js";import"./chunk-ECDCSSJU.js";import{b as J}from"./chunk-NWWTS3XC.js";import{a as Q}from"./chunk-CNYMMHYC.js";import"./chunk-4UPO2QOB.js";import{$a as _,B as A,D as M,Ea as s,K as F,Ka as V,Kb as h,L as j,Pa as v,Qa as O,Sa as z,Ua as p,W as S,Wa as q,Y as T,Ya as G,Za as b,_a as P,a as B,ab as g,b as W,bb as a,cb as o,db as f,eb as w,ga as u,ha as m,hb as C,ib as d,j as N,mb as c,nb as I,ob as H,q as y,r as R,rb as L,sb as E}from"./chunk-2I6WSUOP.js";var k=class i{count=1;static \u0275fac=function(e){return new(e||i)};static \u0275cmp=T({type:i,selectors:[["app-skeleton-loader"]],inputs:{count:"count"},standalone:!0,features:[L],decls:7,vars:0,consts:[[1,"bg-white","rounded-2xl","p-4","border","border-slate-100","h-full","animate-pulse"],[1,"w-full","aspect-[4/5]","bg-slate-200","rounded-xl","mb-4"],[1,"h-4","bg-slate-200","rounded","w-3/4","mb-2"],[1,"h-4","bg-slate-200","rounded","w-1/2","mb-4"],[1,"flex","justify-between","items-center","mt-auto"],[1,"h-6","bg-slate-200","rounded","w-20"],[1,"h-10","bg-slate-200","rounded-full","w-10"]],template:function(e,n){e&1&&(a(0,"div",0),f(1,"div",1)(2,"div",2)(3,"div",3),a(4,"div",4),f(5,"div",5)(6,"div",6),o()())},changeDetection:0})};var se=()=>[D],le=()=>[1,2,3,4,5,6],de=()=>[];function ce(i,t){if(i&1&&(a(0,"option",7),c(1),o()),i&2){let e=t.$implicit;p("value",e._id),s(),I(e.name)}}function pe(i,t){if(i&1&&(a(0,"option",7),c(1),o()),i&2){let e=t.$implicit;p("value",e._id),s(),I(e.name)}}function ue(i,t){i&1&&f(0,"app-skeleton-loader")}function me(i,t){i&1&&(a(0,"div",9),_(1,ue,1,0,"app-skeleton-loader",null,P),o()),i&2&&(s(),g(E(0,le)))}function _e(i,t){if(i&1){let e=w();a(0,"div",12)(1,"app-product-card",13),C("wishlistToggle",function(r){u(e);let l=d(3);return m(l.toggleWishlist(r))}),o()()}if(i&2){let e=d(),n=e.$implicit,r=e.$index;s(),p("index",r)("product",n)("isWishlisted",n.isWishlisted)}}function ge(i,t){if(i&1){let e=w();a(0,"div",12)(1,"app-product-card",13),C("wishlistToggle",function(r){u(e);let l=d(4);return m(l.toggleWishlist(r))}),o()()}if(i&2){let e=d(2),n=e.$implicit,r=e.$index;s(),p("index",r)("product",n)("isWishlisted",n.isWishlisted)}}function fe(i,t){i&1&&f(0,"div",14)}function Ce(i,t){i&1&&(v(0,ge,2,3)(1,fe,1,0),O(2,0,se,null,1),z(0,-1))}function he(i,t){if(i&1&&v(0,_e,2,3,"div",12)(1,Ce,4,0),i&2){let e=t.$index;b(e<3?0:1)}}function xe(i,t){if(i&1&&_(0,he,2,1,null,null,G().trackById,!0),i&2){let e=d();g(e.paginatedProducts())}}function ve(i,t){if(i&1){let e=w();a(0,"button",18),C("click",function(){let r=u(e).$index,l=d(2);return m(l.changePage(r+1))}),c(1),o()}if(i&2){let e=t.$index,n=d(2);q("bg-primary",n.currentPage()===e+1)("text-white",n.currentPage()===e+1)("border-primary",n.currentPage()===e+1)("text-slate-600",n.currentPage()!==e+1),s(),H(" ",e+1," ")}}function be(i,t){if(i&1){let e=w();a(0,"div",10)(1,"button",15),C("click",function(){u(e);let r=d();return m(r.changePage(r.currentPage()-1))}),c(2," Previous "),o(),a(3,"div",16),_(4,ve,2,9,"button",17,P),o(),a(6,"button",15),C("click",function(){u(e);let r=d();return m(r.changePage(r.currentPage()+1))}),c(7," Next "),o()()}if(i&2){let e=d();s(),p("disabled",e.currentPage()===1),s(3),g(E(2,de).constructor(e.totalPages())),s(2),p("disabled",e.currentPage()===e.totalPages())}}function Pe(i,t){i&1&&(a(0,"div",11)(1,"p",19),c(2,"No products found."),o()())}var ie=class i{productService=S(Q);wishlistService=S(K);route=S(J);categoryControl=new $("");brandControl=new $("");ngOnInit(){this.route.queryParams.pipe(M(1)).subscribe(t=>{t.category&&this.categoryControl.setValue(t.category),t.brand&&this.brandControl.setValue(t.brand)})}refreshTrigger$=new N(void 0);productsResource=x(this.refreshTrigger$.pipe(j(()=>this.productService.getAllProducts()),y(t=>t.data)),{initialValue:[]});categoriesResource=x(this.productService.getAllCategories().pipe(y(t=>t.data)),{initialValue:[]});brandsResource=x(this.productService.getAllBrands().pipe(y(t=>t.data)),{initialValue:[]});wishlistIds=x(this.wishlistService.wishlistList,{initialValue:[]});wishlistSet=h(()=>{let t=this.wishlistIds();return new Set(t)});filterState=x(R([this.categoryControl.valueChanges.pipe(F("")),this.brandControl.valueChanges.pipe(F(""))]).pipe(A(300)),{initialValue:["",""]});currentPage=V(1);pageSize=V(6);filteredProducts=h(()=>{let t=this.productsResource(),[e,n]=this.filterState(),r=this.wishlistSet();return t.filter(l=>{let ne=e?l.category._id===e:!0,oe=n?l.brand._id===n:!0;return ne&&oe}).map(l=>W(B({},l),{isWishlisted:r.has(l._id)}))});paginatedProducts=h(()=>{let t=this.filteredProducts(),e=this.currentPage(),n=this.pageSize(),r=(e-1)*n;return t.slice(r,r+n)});totalPages=h(()=>Math.ceil(this.filteredProducts().length/this.pageSize()));categories=this.categoriesResource;brands=this.brandsResource;isLoading=h(()=>this.productsResource().length===0);changePage(t){t>=1&&t<=this.totalPages()&&(this.currentPage.set(t),window.scrollTo({top:0,behavior:"smooth"}))}toggleWishlist(t){this.wishlistSet().has(t)?this.wishlistService.removeFromWishlist(t).subscribe():this.wishlistService.addToWishlist(t).subscribe()}trackById(t,e){return e._id}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=T({type:i,selectors:[["app-product-list"]],standalone:!0,features:[L],decls:23,vars:5,consts:[[1,"container","mx-auto","px-6","py-8"],[1,"flex","flex-col","md:flex-row","md:items-end","justify-between","mb-10"],[1,"text-4xl","font-bold","text-slate-900","tracking-tight","mb-2"],[1,"text-slate-500","text-lg"],[1,"mt-4","md:mt-0","flex","gap-3","flex-wrap"],[1,"px-4","py-2","border","border-slate-300","rounded-lg","bg-white","text-slate-600","focus:border-primary","outline-none",3,"formControl"],["value",""],[3,"value"],[1,"grid","grid-cols-1","sm:grid-cols-2","md:grid-cols-2","lg:grid-cols-3","gap-8",2,"width","100%","height","100%"],[1,"contents"],[1,"flex","justify-center","items-center","gap-4","mt-12","mb-8"],[1,"text-center","py-20"],[1,"animate-fadeIn"],[3,"wishlistToggle","index","product","isWishlisted"],[1,"aspect-[4/5]","bg-slate-50","rounded-2xl","animate-pulse"],[1,"px-4","py-2","rounded-lg","border","border-slate-300","text-slate-600","hover:bg-slate-50","disabled:opacity-50","disabled:cursor-not-allowed","transition-colors",3,"click","disabled"],[1,"flex","gap-2"],[1,"w-10","h-10","rounded-lg","border","border-slate-300","flex","items-center","justify-center","hover:bg-slate-50","transition-colors",3,"bg-primary","text-white","border-primary","text-slate-600"],[1,"w-10","h-10","rounded-lg","border","border-slate-300","flex","items-center","justify-center","hover:bg-slate-50","transition-colors",3,"click"],[1,"text-xl","text-slate-500"]],template:function(e,n){e&1&&(a(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2),c(4,"New Arrivals"),o(),a(5,"p",3),c(6,"Discover our latest collection of premium products."),o()(),a(7,"div",4)(8,"select",5)(9,"option",6),c(10,"All Categories"),o(),_(11,ce,2,2,"option",7,P),o(),a(13,"select",5)(14,"option",6),c(15,"All Brands"),o(),_(16,pe,2,2,"option",7,P),o()()(),a(18,"div",8),v(19,me,3,1,"div",9)(20,xe,2,0),o(),v(21,be,8,3,"div",10)(22,Pe,3,0,"div",11),o()),e&2&&(s(8),p("formControl",n.categoryControl),s(3),g(n.categories()),s(2),p("formControl",n.brandControl),s(3),g(n.brands()),s(3),b(n.isLoading()?19:20),s(2),b(!n.isLoading()&&n.totalPages()>1?21:-1),s(),b(!n.isLoading()&&n.paginatedProducts().length===0?22:-1))},dependencies:[D,k,te,Z,ee,Y,U,X],changeDetection:0})};export{ie as ProductListComponent};
